{% extends "base.html" %}
{% load static humanize %}


{% block title %}Xác nhận đặt lịch · Glamup Nails{% endblock %}

{% block head_extra %}
<style>
  .wrap{max-width:980px;margin:24px auto;padding:0 16px}
  .panel{background:#fff;border:2px solid var(--edge);border-radius:12px;padding:16px}
  .badge-pay{font-weight:900}
</style>
{% endblock %}

{% block content %}
<div class="wrap">
  <div class="alert alert-success fw-600">
    Đặt lịch thành công. Mã hẹn <b>{{ code }}</b>.
    Trạng thái thanh toán:
    {% if paid %}
      <span class="badge bg-success badge-pay">ĐÃ THANH TOÁN</span>
    {% else %}
      <span class="badge bg-warning text-dark badge-pay">CHƯA THANH TOÁN</span>
    {% endif %}
  </div>

  <div class="panel">
    <h5 class="fw-900 mb-3">Appointment Summary</h5>
    <div class="row">
      <div class="col-md-6">
        <p class="mb-1"><b>Ngày:</b> {{ appt.appointment_date|date:"d/m/Y" }}</p>
        <p class="mb-1"><b>Giờ:</b> {{ appt.appointment_time|time:"H:i" }}</p>
        <p class="mb-1"><b>Chi nhánh:</b> {{ appt.branch.name }}</p>
        <p class="mb-1"><b>Ghi chú:</b> {{ appt.note|default:"—" }}</p>
      </div>
      <div class="col-md-6">
        <p class="mb-1"><b>Trạng thái lịch hẹn:</b> {{ appt.get_status_display }}</p>
        {% if payment %}
        <p class="mb-1"><b>Phương thức thanh toán:</b>
          {% if payment.method == payment.Method.ONLINE %}Momo/Banking{% else %}Pay at Store{% endif %}
        </p>
        <p class="mb-1"><b>Trạng thái thanh toán:</b>
          {% if payment.status == payment.Status.PAID %}Đã thanh toán{% else %}Chưa thanh toán{% endif %}
        </p>
        {% endif %}
      </div>
    </div>

    <hr>
    <h6 class="fw-900">Dịch vụ</h6>
    <table class="table table-sm">
      <thead><tr><th>Dịch vụ</th><th class="text-end">Thành tiền</th></tr></thead>
      <tbody>
        {% for l in lines %}
        <tr>
          <td>{{ l.service.service_name }}{% if l.quantity > 1 %} × {{ l.quantity }}{% endif %}</td>
          <td class="text-end">{{ l.unit_price|floatformat:0|intcomma }} VND</td>
        </tr>
        {% endfor %}
        <tr>
          <td class="fw-bold">Tổng cộng</td>
          <td class="text-end fw-bold">{{ amount_vnd }}</td>
        </tr>
      </tbody>
    </table>

    <div class="mt-3">
      <a href="{% url 'main:my_appointments' %}" class="btn btn-outline-brand">Xem lịch hẹn của tôi</a>
      <a href="{% url 'main:home' %}" class="btn btn-brand">Về trang chủ</a>
    </div>
  </div>
</div>
{% endblock %}

{# templates/includes/_sidebar_admin.html #}
{% load static %}
{% block head_extra %}
<style>
  :root{
    --brand:#a5aa7f;   /* olive nhạt */
    --bg:#f6f5ec;      /* nền sáng */
    --ink:#2b3220;     /* chữ đậm */
    --edge:#cfd3a9;    /* viền nhạt */
    --chip:#f4f3e7;    /* nền active/hover */
  }
  body{ background:var(--bg); font-family:'Nunito',sans-serif; }

  /* ===== Sidebar (chuẩn theo mockup) ===== */
  .bo-sidebar{
    background:#e1e6cf;
    border-radius:16px;
    padding:16px;
    position:sticky; top:1rem;
  }

  /* avatar cũ (giữ lại cho an toàn, nhưng giờ dùng wrapper mới) */
  .bo-profile .bo-avatar{
    width:72px;height:72px;border-radius:50%;
    object-fit:cover;border:3px solid #fff;
  }

  /* === Avatar upload giống bên customer === */
  .bo-avatar-wrap{
    position:relative;
    display:inline-flex;
    justify-content:center;
    align-items:center;
    width:72px;
    height:72px;
    border-radius:50%;
    overflow:hidden;
    border:3px solid #fff;
    box-shadow:0 0 0 2px #cfd3a9;
    cursor:pointer;
    background:#fdfcf6;
  }
  .bo-avatar-edit{
    position:absolute;
    right:0;
    bottom:0;
    width:22px;
    height:22px;
    border-radius:999px;
    background:#a5aa7f;
    color:#fff;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:12px;
    box-shadow:0 2px 4px rgba(0,0,0,.25);
  }
  .bo-avatar-edit i{ line-height:1; }
  .bo-avatar-input{ display:none; }

  .bo-profile .bo-role{ color:#6c7551; font-weight:700; }

  .bo-menu{ margin-top:12px }
  .bo-item{
    display:flex; align-items:center; gap:.75rem;
    padding:.6rem .8rem; border-radius:12px;
    color:var(--ink); text-decoration:none; font-weight:800;
    transition:background .15s, box-shadow .15s;
  }
  .bo-item:hover{ background:var(--chip);text-decoration: none }
  .bo-item.active{
    background:var(--chip);
    box-shadow: inset 0 0 0 2px #d6d1b8;
  }
  .bo-ic{
    width:36px;height:36px;border-radius:50%;
    display:grid;place-items:center;
    border:2px solid var(--edge); color:#71804f;
    background:#fff;
    flex:0 0 36px;
  }
</style>
{% endblock %}

<div class="bo-sidebar">
  <!-- Header -->
  <div class="bo-profile d-flex align-items-center gap-3 mb-3">

    {# FORM UPLOAD AVATAR CHO ADMIN – click vào avatar để chọn ảnh #}
    <form id="adminAvatarForm"
          method="post"
          action="{% url 'main:staff_account' %}"   {# nơi xử lý upload avatar cho staff/admin #}
          enctype="multipart/form-data">
      {% csrf_token %}
      <input type="hidden" name="action" value="upload_avatar">

      <label for="id_admin_avatar_input"
             class="bo-avatar-wrap"
             title="Change avatar">
        {% if staff_avatar_url %}
          <img src="{{ staff_avatar_url }}" class="bo-avatar" alt="avatar">
        {% else %}
          <img src="{% static 'img/ảnh_người_1.jpg' %}" class="bo-avatar" alt="avatar">
        {% endif %}
        <span class="bo-avatar-edit">
          <i class="bi bi-camera-fill"></i>
        </span>
      </label>

      <input id="id_admin_avatar_input"
             class="bo-avatar-input"
             type="file"
             name="avatar"
             accept="image/*"
             onchange="document.getElementById('adminAvatarForm').submit();">
    </form>

    <div>
      <div class="bo-role small">Admin</div>
      <div class="fw-bold">{{ request.user.get_full_name|default:request.user.username }}</div>
    </div>
  </div>

  <!-- Menu -->
  <nav class="bo-menu d-grid gap-2">
    <!-- 1. Dashboard -->
    <a class="bo-item {% if active == 'dashboard' %}active{% endif %}"
       href="{% url 'main:admin_dashboard' %}">
      <span class="bo-ic"><i class="bi bi-bar-chart"></i></span>
      Dashboard
    </a>

    <!-- 2. Employee -->
    <a class="bo-item {% if active == 'employee' %}active{% endif %}"
       href="{% url 'main:admin_employee' %}">
      <span class="bo-ic"><i class="bi bi-people"></i></span>
      Employee
    </a>

    <!-- 3. Schedule Employee -->
    <a class="bo-item {% if active == 'schedule' %}active{% endif %}"
       href="{% url 'main:admin_schedule' %}">
      <span class="bo-ic"><i class="bi bi-calendar-week"></i></span>
      Schedule Employee
    </a>

    <!-- 4. Service -->
    <a class="bo-item {% if active == 'service' %}active{% endif %}"
       href="{% url 'main:admin_service' %}">
      <span class="bo-ic"><i class="bi bi-heart"></i></span>
      Service
    </a>

    <!-- 5. Branch -->
    <a class="bo-item {% if active == 'branch' %}active{% endif %}"
       href="{% url 'main:branch_list' %}">
      <span class="bo-ic"><i class="bi bi-calendar-week"></i></span>
      Branch
    </a>

    <!-- 6. Feedback -->
    <a class="bo-item {% if active == 'feedback' %}active{% endif %}"
       href="{% url 'main:admin_feedback' %}">
      <span class="bo-ic"><i class="bi-chat-dots"></i></span>
      Feedback
    </a>
  </nav>

</div>

<script>
  document.addEventListener('DOMContentLoaded', function(){
    const link = document.getElementById('logout-link');
    if(link){
      link.addEventListener('click', function(e){
        e.preventDefault();
        document.getElementById('logout-form').submit();
      });
    }
  });
</script>
